# Claude Code Working Agreement (NEBULAB Corporate)

このリポジトリに対して Claude Code が作業するときの約束事（規約）です。
目的は「意図がブレない」「変更が過剰にならない」「運用しやすい単一ソース設計を守る」ことです。

---

## 0. 絶対ルール（最優先）

1) **build / dev server / test 実行はしない**
- `npm run dev`, `npm run build`, `pnpm`, `yarn`, `bun` を含む実行コマンドは提案も実行もしない
- 代わりに「静的な根拠（ファイル/行/参照関係）」で判断する

2) **既存の構造を壊さない（大改修しない）**
- フォルダ構成やページ構造の変更は原則禁止
- “必要最小限の差分”で目的を達成する

3) **単一ソース（constants）を増やす方向で揃える**
- 重複定義を見つけたら、可能なら `src/constants` に寄せる
- ただし、変更範囲が大きくなる場合は「段階的プラン」を提示し、今回は最小対応に留める

4) **推測で本文や日付を勝手に作らない**
- 会社情報、活動開始日、実績などの事実情報は **与えられた前提**に従う
- 不明な内容は「要確認」としてプレースホルダで済ませない（勝手に埋めない）

---

## 1. 作業の進め方（毎回この順で）

### Step A: 調査（Read-only）
- 対象の挙動が「どのページ→どのコンポーネント→どの定数」を通って表示されるか、根拠付きで提示
- 影響範囲（参照されるページ一覧）を列挙

### Step B: 設計案（最小差分）
- 変更方針を 1〜2案に絞って提示
- 各案の「変更ファイル」「変更行数の規模感」「メリット/デメリット」を書く
- 今回の採用案を明確化

### Step C: 実装（Diff 중심）
- 必ず **変更ファイル一覧** を先に出す
- 可能なら **diff形式**（before/after or patch）で提示
- 既存 UI の見た目や文言のトーンは崩さない

### Step D: 仕上げ（整合性）
- ナビ/フッター/サイトマップ/定数の整合を確認（参照が分裂していないか）
- “リンク切れ” や “未使用コンポーネント” の疑いがあれば報告（削除は勝手にしない）

---

## 2. コーディング規約（このリポジトリの前提）

- Next.js **App Router**（`src/app`）
- TS/React: 関数は基本アロー関数
- 命名: 変数 camelCase / type・interface PascalCase / Component PascalCase
- 変更は「意図が伝わる」粒度で。雑な `initializePage` などは避け、**具体名**にする

### コメント方針
- 重要な意図・仕様には **コメント or JSDoc** を付ける
- ただしコメント過多にしない（“判断理由”が必要な箇所に限定）

---

## 3. 情報設計（IA）を触るときのルール

- 情報設計は「分類」と「導線」の問題として扱う
- 既存のカテゴリ（About / Services / Projects / Insights / News / NRT-LOFT）を前提に、
  追加のカテゴリ（例: Products）を作る場合は **既存との役割分担**を明確化する
- ナビやサイトマップは、可能なら **単一ソース** に寄せる（ただし一気にやらない）

---

## 4. 定数・データ配置の優先順位

優先順位（上ほど良い）:
1) `src/constants/*`（単一ソース）
2) ページ直下の `const`（そのページに閉じるならOK）
3) 複数ファイルへの直書き（NG）

追加/変更の基本:
- 会社情報: `src/constants/brand.ts`
- MVV: `src/constants/mvv.ts`
- News: `src/constants/news.ts`
- Projects: `src/constants/projects.ts`
- （新設する場合）Services / Insights / Sitemap も `src/constants` を優先

---

## 5. UI/導線に関する注意

- `/#contact` のようなアンカーは「該当セクションがトップに存在する場合のみ」
- 外部リンクは `target="_blank"` + `rel="noopener noreferrer"` を守る（既存実装に準拠）
- “準備中/暫定運用” の文言は信頼を落とすので、表示が必要なら言い方を整える（勝手に削除しない）

---

## 6. 出力フォーマット（Claude Codeの回答形式）

必ず以下を含めること:

1) 調査結果（根拠: ファイルパス + 行番号 or 該当コード断片）
2) 採用案（なぜそれが最小差分か）
3) 変更ファイル一覧
4) 実装差分（diff or before/after）
5) 影響範囲チェック（どのページに効くか）
6) 残課題（今回やらないが必要になりそうなこと）

---

## 7. このリポジトリ固有の前提（重要）

- 「buildして確認」などの実行指示は **入れない**
- 既存サイトは “コーポレート” だが、実態は “Lab/Studio のポータル”
- 事実情報の前提が与えられた場合は、それを最優先で反映する（例: 活動開始=2025年7月）

以上。